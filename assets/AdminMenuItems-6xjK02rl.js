import{c as N,r as i,j as e,m as F,X as q,I as w,B as g,a as E,V as h,A as P,f as T,l as D,n as U,o as R,p as V}from"./index-o665ZfVT.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=N("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=N("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=N("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=N("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=N("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),M=({initialData:c,onSubmit:f,onCancel:k})=>{const[r,o]=i.useState(c||{name:"",description:"",price:0,category:"",image_url:"",is_available:!0,is_special:!1}),[C,b]=i.useState([]),[I,j]=i.useState(!1),[d,u]=i.useState({});i.useEffect(()=>{(async()=>{try{const t=await E();b(t),!c&&t.length>0&&!r.category&&o(n=>({...n,category:t[0].name}))}catch(t){console.error("Failed to load categories:",t),h.error("Failed to load categories")}})()},[c,r.category]);const m=s=>{const{name:t,value:n,type:y}=s.target;if(y==="checkbox"){const x=s.target.checked;o(v=>({...v,[t]:x}))}else if(t==="price"){const x=parseFloat(n);o(v=>({...v,[t]:isNaN(x)?0:x}))}else o(x=>({...x,[t]:n}))},S=()=>{var t,n,y;const s={};return(t=r.name)!=null&&t.trim()||(s.name="Name is required"),(n=r.description)!=null&&n.trim()||(s.description="Description is required"),r.category||(s.category="Category is required"),(r.price===void 0||r.price<=0)&&(s.price="Price must be greater than 0"),(y=r.image_url)!=null&&y.trim()||(s.image_url="Image URL is required"),u(s),Object.keys(s).length===0},p=async s=>{if(s.preventDefault(),!!S())try{j(!0),await f(r),h.success(`${c?"Updated":"Created"} menu item successfully`)}catch(t){console.error("Failed to save menu item:",t),h.error(`Failed to ${c?"update":"create"} menu item`)}finally{j(!1)}};return e.jsxs(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"card max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-heading font-bold",children:c?"Edit Menu Item":"Add New Menu Item"}),e.jsx("button",{onClick:k,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx(q,{size:24})})]}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsx(w,{label:"Name",name:"name",value:r.name||"",onChange:m,placeholder:"Enter item name",error:d.name}),e.jsx(w,{label:"Price (â‚¦)",name:"price",type:"number",step:"0.01",min:"0",value:r.price||"",onChange:m,placeholder:"Enter price",error:d.price})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:r.description||"",onChange:m,placeholder:"Enter item description",className:"input w-full h-24 resize-none"}),d.description&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:d.description})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),e.jsxs("select",{name:"category",value:r.category||"",onChange:m,className:"input w-full",children:[e.jsx("option",{value:"",children:"Select category"}),C.map(s=>e.jsx("option",{value:s.name,children:s.display_name},s.id))]}),d.category&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:d.category})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(w,{label:"Image URL",name:"image_url",value:r.image_url||"",onChange:m,placeholder:"Enter image URL",error:d.image_url}),r.image_url&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:r.image_url,alt:"Preview",className:"w-32 h-32 object-cover rounded-lg",onError:()=>{o(s=>({...s,image_url:""})),u(s=>({...s,image_url:"Invalid image URL"}))}})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"is_available",checked:r.is_available===!0,onChange:s=>{o(t=>({...t,is_available:s.target.checked}))},className:"form-checkbox h-5 w-5 text-primary-500 rounded focus:ring-primary-400"}),e.jsx("span",{className:"ml-2 text-sm",children:"Available"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"is_special",checked:r.is_special===!0,onChange:s=>{o(t=>({...t,is_special:s.target.checked}))},className:"form-checkbox h-5 w-5 text-accent-400 rounded focus:ring-accent-400"}),e.jsx("span",{className:"ml-2 text-sm",children:"Mark as Today's Special"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(g,{type:"button",variant:"secondary",onClick:k,children:"Cancel"}),e.jsx(g,{type:"submit",variant:"primary",isLoading:I,children:c?"Update Item":"Add Item"})]})]})]})},$=()=>{const[c,f]=i.useState([]),[k,r]=i.useState([]),[o,C]=i.useState(!0),[b,I]=i.useState(""),[j,d]=i.useState("all"),[u,m]=i.useState(null),[S,p]=i.useState(!1),[s,t]=i.useState(null),n=async()=>{try{C(!0);const a=await D();f(a);const l=await E();r(l)}catch(a){console.error("Failed to load data:",a),h.error("Failed to load menu items")}finally{C(!1)}};i.useEffect(()=>{n()},[]);const y=c.filter(a=>{const l=a.name.toLowerCase().includes(b.toLowerCase())||a.description.toLowerCase().includes(b.toLowerCase()),z=j==="all"||a.category===j;return l&&z}),x=a=>{m(a),p(!1)},v=async a=>{if(u)try{await U(u.id,a),f(c.map(l=>l.id===u.id?{...l,...a}:l)),m(null),n()}catch(l){console.error("Failed to update menu item:",l),h.error("Failed to update menu item")}},A=async a=>{try{await R(a),p(!1),n()}catch(l){console.error("Failed to create menu item:",l),h.error("Failed to create menu item")}},L=async a=>{try{await V(a),f(c.filter(l=>l.id!==a)),t(null),h.success("Menu item deleted successfully")}catch(l){console.error("Failed to delete menu item:",l),h.error("Failed to delete menu item")}};return u?e.jsx(M,{initialData:u,onSubmit:v,onCancel:()=>m(null)}):S?e.jsx(M,{onSubmit:A,onCancel:()=>p(!1)}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[e.jsx("h1",{className:"text-2xl font-heading font-bold",children:"Menu Items"}),e.jsx(g,{variant:"primary",leftIcon:e.jsx(_,{size:18}),onClick:()=>p(!0),children:"Add New Item"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx(w,{type:"text",placeholder:"Search menu items...",value:b,onChange:a=>I(a.target.value),className:"pl-10"})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("select",{value:j,onChange:a=>d(a.target.value),className:"input w-full",children:[e.jsx("option",{value:"all",children:"All Categories"}),k.map(a=>e.jsx("option",{value:a.name,children:a.display_name},a.id))]})})]}),o?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((a,l)=>e.jsxs("div",{className:"card animate-pulse",children:[e.jsx("div",{className:"rounded-xl mb-3 h-40 bg-gray-200 dark:bg-gray-700"}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full mb-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/3"})]})]},l))}):y.length===0?e.jsxs("div",{className:"card p-6 text-center",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No menu items found. Try adjusting your search or category filter."}),e.jsx(g,{variant:"primary",leftIcon:e.jsx(_,{size:18}),onClick:()=>p(!0),children:"Add New Item"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.jsx(P,{children:y.map(a=>e.jsxs(F.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"card relative overflow-hidden",children:[s===a.id&&e.jsxs("div",{className:"absolute inset-0 bg-white dark:bg-gray-800 bg-opacity-95 dark:bg-opacity-95 z-10 flex flex-col items-center justify-center p-4",children:[e.jsx(B,{className:"text-red-500 mb-3",size:32}),e.jsx("h3",{className:"text-lg font-heading font-semibold mb-2",children:"Delete this item?"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-4",children:"This action cannot be undone."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"secondary",onClick:()=>t(null),children:"Cancel"}),e.jsx(g,{variant:"danger",onClick:()=>L(a.id),children:"Delete"})]})]}),e.jsxs("div",{className:"relative overflow-hidden rounded-xl mb-3 h-40",children:[e.jsx("img",{src:a.image_url||"https://images.pexels.com/photos/1640772/pexels-photo-1640772.jpeg",alt:a.name,className:"w-full h-full object-cover",loading:"lazy"}),a.is_special&&e.jsx("div",{className:"absolute top-2 right-2 bg-accent-400 text-black text-xs font-semibold py-1 px-2 rounded-lg",children:"Today's Special"}),!a.is_available&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold px-2 py-1 rounded-lg",children:"Out of Stock"})})]}),e.jsx("h3",{className:"font-heading text-lg font-semibold mb-1",children:a.name}),e.jsx("p",{className:"text-primary-500 font-medium mb-2",children:T(a.price)}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm line-clamp-2 mb-4",children:a.description}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"secondary",leftIcon:e.jsx(O,{size:16}),onClick:()=>x(a),className:"text-sm py-1.5",children:"Edit"}),e.jsx(g,{variant:"danger",leftIcon:e.jsx(Q,{size:16}),onClick:()=>t(a.id),className:"text-sm py-1.5",children:"Delete"})]})]},a.id))})})]})};export{$ as default};
