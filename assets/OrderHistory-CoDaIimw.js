import{c as h,r as d,s as m,j as e,m as n,B as b,b as j,f as x,d as f,V as v}from"./index-o665ZfVT.js";import{C as N}from"./chevron-down-CDWM3Qa_.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=h("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=h("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),_=()=>{const[l,g]=d.useState([]),[y,c]=d.useState(!0),[i,o]=d.useState(null);d.useEffect(()=>{const a=async()=>{const s=localStorage.getItem("customer_id");if(!s){c(!1);return}try{const r=await f(s);g(r)}catch(r){console.error("Failed to load orders:",r),v.error("Failed to load your order history")}finally{c(!1)}};a();const t=m.channel("orders-channel").on("postgres_changes",{event:"*",schema:"public",table:"orders",filter:`customer_id=eq.${localStorage.getItem("customer_id")}`},()=>{a()}).subscribe();return()=>{m.removeChannel(t)}},[]);const u=a=>{o(i===a?null:a)},p=a=>{switch(a){case"Pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"Preparing":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"Completed":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"Cancelled":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300"}};return y?e.jsxs("div",{className:"max-w-4xl mx-auto py-6",children:[e.jsx("h1",{className:"text-3xl font-heading font-bold mb-6",children:"Order History"}),e.jsx("div",{className:"animate-pulse space-y-4",children:[...Array(3)].map((a,t)=>e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]},t))})]}):e.jsxs("div",{className:"max-w-4xl mx-auto min-h-[calc(100vh-16rem)]",children:[e.jsxs(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-heading font-bold mb-2",children:"Order History"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"View and track all your previous orders"})]}),l.length===0?e.jsxs(n.div,{initial:{opacity:0},animate:{opacity:1},className:"card p-8 text-center",children:[e.jsx(w,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("h3",{className:"text-xl font-heading font-semibold mb-2",children:"No Orders Yet"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You haven't placed any orders yet. Head over to the menu to get started!"}),e.jsx(b,{as:"a",href:"/",variant:"primary",children:"Browse Menu"})]}):e.jsx("div",{className:"space-y-4",children:l.map(a=>{var t;return e.jsxs(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"card overflow-hidden",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-2 cursor-pointer",onClick:()=>u(a.id),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-heading font-semibold",children:["Table ",a.table_number]}),e.jsx("span",{className:`badge ${p(a.status)}`,children:a.status})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:j(a.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-bold text-primary-500",children:x(a.total_amount)}),i===a.id?e.jsx(k,{size:20}):e.jsx(N,{size:20})]})]}),i===a.id&&e.jsxs(n.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:[e.jsx("hr",{className:"my-3 border-gray-200 dark:border-gray-700"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Order Items:"}),e.jsx("ul",{className:"space-y-2",children:(t=a.order_items)==null?void 0:t.map(s=>{var r;return e.jsxs("li",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"font-medium",children:[s.quantity,"x"]}),e.jsx("span",{children:(r=s.menu_items)==null?void 0:r.name})]}),e.jsx("span",{className:"font-medium",children:x(s.price*s.quantity)})]},s.id)})})]})]})]},a.id)})})]})};export{_ as default};
